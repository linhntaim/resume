$(document).ready(function(){function g(a,b,c,d){f.modal("hide"),setTimeout(function(){f.find(".modal-title").html(a),f.find(".modal-body").html(b),f.modal("show"),d&&f.on("hide.bs.modal",function(){d.call(f),f.off("hide.bs.modal")}),c&&setTimeout(function(){f.modal("hide")},c)},500)}function i(a){return a>=65&&a<=90}function j(a){return[112,113].indexOf(a)!=-1}var a=$("body > nav"),b=$("body > header"),c=a.find(".dropdown-bars"),d=function(){a.offset().top>b.height()-32?a.removeClass("hidden"):(c.parent().hasClass("open")&&c.trigger("click"),a.addClass("hidden"))};$(window).scroll(d),d(),$("a.page-scroll").on("click",function(b){var c=$(this);$("html, body").stop().animate({scrollTop:$(c.attr("href")).offset().top-a.height()},1500,"easeInOutExpo"),b.preventDefault()}),$("body > main .h3").on("click",function(a){$(this).next().toggle("slow"),a.preventDefault()}),$("body > main .title").on("click",function(a){$(this).next().next().toggle("slow"),a.preventDefault()});var e=$("#modal-download");e.on("shown.bs.modal",function(a){var b=$(a.relatedTarget).data();b&&b.download&&$(b.download).children("a").addClass("active")}).on("hidden.bs.modal",function(a){e.find(".active").removeClass("active")}),e.find(".modal-body a").on("click",function(){e.find(".active").removeClass("active")});var f=$("#modal-empty"),k={commands:{},noTry:!1,stack:[""],timeoutTrying:null,register:function(a,b,c){this.commands[a]={data:b,runCallback:c}},resetTryToRun:function(){this.stack=[""]},tryToRun:function(a){var b=this;return b.noTry?void b.resetTryToRun():(b.timeoutTrying&&clearTimeout(b.timeoutTrying),b.stack.push(b.stack.pop()+a),void(b.timeoutTrying=setTimeout(function(){var a=b.stack.join("").toLowerCase();for(var c in b.commands){var d=b.commands[c],e=c.split("|");for(var f in e){var g=e[f].toLowerCase(),h=a.substr(a.length-g.length);if(h==g)return d.runCallback.call(d,g),void b.resetTryToRun()}}},500)))},run:function(a){this.resetTryToRun(),a=a.toLowerCase();for(var b in this.commands)if(b.toLowerCase().split("|").indexOf(a)!=-1){var c=this.commands[b];if(c)return c.runCallback.call(c,a),!0}return!1}};$(document).on("click",".command-open",function(a){a.preventDefault(),k.run("command")}),k.register("help",null,function(){g(TRANS.help,TRANS.help_content)}),k.register("vi",null,function(){window.location.href=VARS.URL_VI}),k.register("en",null,function(){window.location.href=VARS.URL_EN}),$(document).on("change","#command-line",function(){var a=$(this),b=a.closest(".input-group"),c=a.val(),d=null;return b.next().remove(),0==c.trim().length?d=TRANS.command_not_empty:k.run(c)||(d=TRANS.command_not_valid),null!=d?void b.after('<div class="help-block">'+d+"</div>"):void f.modal("hide")}).on("click","#command-run",function(a){a.preventDefault(),$("#command-line").trigger("change")}),k.register("cmd|run|console|command",null,function(){g(TRANS.run_command,'<div class="form-group"><label class="sr-only" for="console">'+TRANS.command+'</label><div class="input-group"><input id="command-line" name="command-line" type="text" class="form-control"><span id="command-run" class="input-group-addon">â†µ</span></div></div>',null,function(){k.noTry=!1}),k.noTry=!0,setTimeout(function(){$("#command-line").focus()},1e3)}),k.register("refresh",null,function(){var a=3;g(TRANS.reload,TRANS.reload_after.replace(":second",a)),setTimeout(function(){window.location.reload(!0)},1e3*a)}),k.register("hello|hi",{messages:[TRANS.how_are_you,TRANS.nice_day,TRANS.glhf,TRANS.wish],oldIndex:-1,randomIndex:function(){for(var a=Math.floor(Math.random()*this.messages.length);a==this.oldIndex;)a=Math.floor(Math.random()*this.messages.length);return this.oldIndex=a,a},randomMessage:function(){return this.messages[this.randomIndex()]}},function(a){g("hi"==a?TRANS.hi:TRANS.hello,this.data.randomMessage())}),k.register("music",{rythm:null,playing:!1,start:function(){null==this.rythm&&(this.rythm=new Rythm),this.rythm.setMusic(VARS.MUSIC),this.rythm.start(),this.playing=!0},stop:function(){this.rythm.stop(),this.playing=!1},play:function(){console.log(this),this.playing?(this.stop(),g(TRANS.music,TRANS.music_off,3e3)):(this.start(),g(TRANS.music,TRANS.music_on,4e3))}},function(){this.data.play()}),k.register("expand|show",null,function(){$("body > main .title").each(function(){$(this).next().next().is(":hidden")&&$(this).trigger("click")}),$("body > main .h3").each(function(){$(this).next().is(":hidden")&&$(this).trigger("click")}),f.modal("hide")}),k.register("collapse|hide",null,function(){$("body > main .h3").each(function(){$(this).next().is(":visible")&&$(this).trigger("click")}),$("body > main .title").each(function(){$(this).next().next().is(":visible")&&$(this).trigger("click")}),f.modal("hide")}),k.register("download",null,function(){e.modal("show")}),$(document).on("keydown",function(a){j(a.which)&&112==a.which&&(k.run("help"),a.preventDefault())}).on("keyup",function(a){a.preventDefault(),i(a.which)?k.tryToRun(a.key):k.resetTryToRun()}),$(document).on("click",".help",function(a){a.preventDefault(),k.run("help")});var l=1050;$(document).on("shown.bs.modal",".modal",function(a){$(".modal-backdrop:last").css("z-index",++l),$(this).css("z-index",++l)}).on("hidden.bs.modal",".modal",function(a){l-=2})});